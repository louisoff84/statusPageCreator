<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uptime - Login / Register</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 min-h-screen flex items-center justify-center p-4">

    <div class="max-w-md w-full bg-white p-8 rounded-2xl shadow-xl border border-slate-200">
        
        <div class="flex border-b mb-6">
            <button id="tab-login" onclick="switchTab('login')" class="flex-1 py-2 font-bold text-blue-600 border-b-2 border-blue-600">Connexion</button>
            <button id="tab-register" onclick="switchTab('register')" class="flex-1 py-2 font-bold text-slate-400 border-b-2 border-transparent">Inscription</button>
        </div>

        <h1 id="form-title" class="text-xl font-bold mb-6 text-slate-800">Ravi de vous revoir</h1>

        <form id="auth-form" onsubmit="handleAuth(event)" class="space-y-4">
            <div>
                <label class="block text-xs font-bold uppercase text-slate-400 mb-1">Email</label>
                <input type="email" id="email" required class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition">
            </div>
            <div>
                <label class="block text-xs font-bold uppercase text-slate-400 mb-1">Mot de passe</label>
                <input type="password" id="password" required class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition">
            </div>
            
            <button type="submit" id="submit-btn" class="w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition shadow-lg shadow-blue-200">
                Se connecter
            </button>
        </form>

        <p id="msg" class="mt-4 text-center text-sm font-medium"></p>
    </div>

    <script>
        let currentMode = 'login';

        // Changer entre Login et Register
        function switchTab(mode) {
            currentMode = mode;
            const isLogin = mode === 'login';
            
            // UI Update
            document.getElementById('form-title').textContent = isLogin ? 'Ravi de vous revoir' : 'Créer un compte';
            document.getElementById('submit-btn').textContent = isLogin ? 'Se connecter' : 'S\'inscrire';
            
            document.getElementById('tab-login').className = isLogin ? 'flex-1 py-2 font-bold text-blue-600 border-b-2 border-blue-600' : 'flex-1 py-2 font-bold text-slate-400 border-b-2 border-transparent';
            document.getElementById('tab-register').className = !isLogin ? 'flex-1 py-2 font-bold text-blue-600 border-b-2 border-blue-600' : 'flex-1 py-2 font-bold text-slate-400 border-b-2 border-transparent';
            
            document.getElementById('msg').textContent = '';
        }

        function handleAuth(e) {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const msg = document.getElementById('msg');

            // Récupérer les utilisateurs existants
            let users = JSON.parse(localStorage.getItem('users')) || [];

            if (currentMode === 'register') {
                // S'INSCRIRE
                const exists = users.find(u => u.email === email);
                if (exists) {
                    msg.className = "mt-4 text-center text-sm font-medium text-red-500";
                    msg.textContent = "Cet email est déjà utilisé.";
                    return;
                }

                users.push({ email, password });
                localStorage.setItem('users', JSON.stringify(users));
                
                msg.className = "mt-4 text-center text-sm font-medium text-green-500";
                msg.textContent = "Compte créé ! Connectez-vous maintenant.";
                switchTab('login');

            } else {
                // SE CONNECTER
                const user = users.find(u => u.email === email && u.password === password);
                if (user) {
                    msg.className = "mt-4 text-center text-sm font-medium text-green-500";
                    msg.textContent = "Connexion réussie... redirection";
                    
                    // Stocker la session et rediriger vers l'index
                    sessionStorage.setItem('isLoggedIn', 'true');
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 1000);
                } else {
                    msg.className = "mt-4 text-center text-sm font-medium text-red-500";
                    msg.textContent = "Email ou mot de passe incorrect.";
                }
            }
        }
    </script>
</body>
</html>
